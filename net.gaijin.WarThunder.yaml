app-id: net.gaijin.WarThunder
runtime: org.gnome.Platform
runtime-version: '41'
sdk: org.gnome.Sdk
command: run.sh
finish-args:
  - --socket=x11
  - --device=dri
  # =all for controller support
  - --device=all
  - --socket=pulseaudio
  - --share=network
  - --persist=.config/WarThunder/

modules:
  - name: warthunder
    buildsystem: simple
    build-commands: 
      - install -D -t "${FLATPAK_DEST}/bin/" ./run.sh
      - install -D ./apply_extra.sh "${FLATPAK_DEST}/bin/apply_extra"
      - install -D -t "${FLATPAK_DEST}/share/applications/" ./net.gaijin.WarThunder.desktop
    sources:
      - type: extra-data
        filename: wt.tar.gz
        url: https://cdnnow-distr.gaijinent.com/wt_launcher_linux_0.9.4.74.tar.gz
        sha256: 68d4e26c170091f9ede93730f8d258e72af5f325c256ffa6e44fdb9ad0c7d638
        # curl -s -L -I "URL" | gawk -v IGNORECASE=1 '/^Content-Length/ { print $2 }'
        size: 19275822
      - type: file
        path: run.sh
      - type: file
        path: net.gaijin.WarThunder.desktop
      - type: file
        path: apply_extra.sh
