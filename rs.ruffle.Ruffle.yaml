app-id: rs.ruffle.Ruffle
runtime: org.freedesktop.Platform
runtime-version: '22.08'
sdk: org.freedesktop.Sdk
command: ruffle

finish-args:
  - --socket=wayland
# <x11
  - --socket=x11 # required for arboard fault
  - --share=ipc
# x11>
  - --socket=pulseaudio
  - --share=network # Flash can connect to the internet
  - --device=all # controllers (?)

modules:
  - name: ruffle
    buildsystem: simple
    build-commands:
      - install -D -t "${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/" ./rs.ruffle.Ruffle.svg
      - install -D -t "${FLATPAK_DEST}/share/applications/" ./rs.ruffle.Ruffle.desktop
      - install -D -t "${FLATPAK_DEST}/share/metainfo/" ./rs.ruffle.Ruffle.metainfo.xml
      - install -D -t "${FLATPAK_DEST}/bin/" ./ruffle
    sources:
      - type: file
        path: rs.ruffle.Ruffle.metainfo.xml # Waiting for PR merge
      - type: file
        path: rs.ruffle.Ruffle.desktop
      - type: file
        path: assets/logo.svg  # Waiting for PR merge https://github.com/ruffle-rs/ruffle/pull/11226
        dest-filename: rs.ruffle.Ruffle.svg
      - type: archive
        url: https://github.com/ruffle-rs/ruffle/releases/download/nightly-2023-05-30/ruffle-nightly-2023_05_30-linux-x86_64.tar.gz
        sha256: dda7c9a6f4d959d40ba5760632a8109c51a4fcf464d00bf2deafc7586816538a
        strip-components: 0
        x-checker-data:
          type: html
          url: https://ruffle.rs/
          pattern: (https:\/\/github\.com\/ruffle-rs\/ruffle\/releases\/download\/.+\/ruffle-nightly-(\d{4}_\d{2}_\d{2})-linux-x86_64\.tar\.gz)
