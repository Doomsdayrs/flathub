app-id: info.cemu.Cemu
runtime: org.gnome.Platform
runtime-version: '42'
sdk: org.gnome.Sdk

command: Cemu

finish-args:
  - --socket=x11
  - --share=ipc
  - --device=all
  - --socket=pulseaudio
  - --share=network

modules:
  # Needed for imgui
  - name: glfw
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
      - -DBUILD_SHARED_LIBS=ON
      - -DGLFW_BUILD_EXAMPLES=OFF
      - -DGLFW_BUILD_TESTS=OFF
      - -DGLFW_BUILD_DOCS=OFF
    sources:
      - type: archive
        url: https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
        sha256: 08a33a512f29d7dbf78eab39bd7858576adcc95228c9efe8e4bc5f0f3261efc7
    cleanup:
      - /include
      - /lib/pkgconfig

  # Needed for imgui
  - name: glad
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
      - -DBUILD_SHARED_LIBS=true
      - -DGLAD_REPRODUCIBLE=true
      - -DGLAD_INSTALL=true
    sources:
      - type: archive
        url: https://github.com/Dav1dde/glad/archive/refs/tags/v0.1.36.tar.gz
        sha256: 8470ed1b0e9fbe88e10c34770505c8a1dc8ccb78cadcf673331aaf5224f963d2

  # Needed for Cemu
  - name: imgui
    buildsystem: cmake
    sources:
      - type: archive
        url: https://github.com/ocornut/imgui/archive/refs/tags/v1.88.zip
        sha256: 81087a74599e5890a07b636887cee73a7dc1a9eb9e1f19a4a0d82a76090bf4c2
      - type: file
        path: imguiCMakeLists.txt
        dest-filename: CMakeLists.txt
        
        
    
  - name: pugixml
    buildsystem: cmake-ninja
    config-opts:
      - -DBUILD_SHARED_LIBS=on .
    sources:
      - type: archive
        url: https://github.com/zeux/pugixml/releases/download/v1.11.4/pugixml-1.11.4.tar.gz
        sha256: 8ddf57b65fb860416979a3f0640c2ad45ddddbbafa82508ef0a0af3ce7061716

  - name: Cemu
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
      - -DENABLE_VCPKG=false
      - -DCMAKE_BUILD_TYPE=release 
      - -DCMAKE_C_COMPILER=/usr/bin/gcc 
      - -DCMAKE_CXX_COMPILER=/usr/bin/g++
      - -G Ninja
      - -DCMAKE_MAKE_PROGRAM=/usr/bin/ninja
    sources:
      - type: git
        url: https://github.com/cemu-project/Cemu
        commit: d8da8a54a6c08296a884b892d714cabcb7e4bdb5
